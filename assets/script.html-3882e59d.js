import{_ as l}from"./console_en-27f14f83.js";import{_ as r,X as u,Y as d,Z as n,a0 as s,$ as a,a1 as k,a2 as e,B as o}from"./framework-e053119e.js";const h="/fast-request/img/script_en.png",g="/fast-request/img/2022.2.3/scriptDonate_en.png",m={},v=n("p",null,[n("strong",null,"Function"),s(": Developers can use Groovy scripts to customize some logic, which makes the API more flexible, such as dynamically encrypting and signing parameters and putting them in the header rather than directly writing dead.")],-1),f=n("strong",null,"Language",-1),_={href:"https://groovy-lang.org/",target:"_blank",rel:"noopener noreferrer"},b=n("p",null,"The groovy syntax is almost identical to Java.",-1),y=n("h2",{id:"script-flow-chart",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#script-flow-chart","aria-hidden":"true"},"#"),s(" Script flow chart")],-1),x=n("h2",{id:"test-project",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#test-project","aria-hidden":"true"},"#"),s(" Test Project")],-1),q={href:"https://github.com/kings1990/fast-request-samples",target:"_blank",rel:"noopener noreferrer"},w=e(`<h2 id="case" tabindex="-1"><a class="header-anchor" href="#case" aria-hidden="true">#</a> Case</h2><ul class="task-list-container"><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-0" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-0"> Put md5 sign to header</label></li></ul><div class="language-groovy" data-ext="groovy"><pre class="language-groovy"><code><span class="token keyword">import</span> cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>core<span class="token punctuation">.</span>util<span class="token punctuation">.</span>CharsetUtil
<span class="token keyword">import</span> cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>core<span class="token punctuation">.</span>util<span class="token punctuation">.</span>StrUtil
<span class="token keyword">import</span> cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>digest<span class="token punctuation">.</span>DigestUtil

String body <span class="token operator">=</span> StrUtil<span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">bodyBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> CharsetUtil<span class="token punctuation">.</span>CHARSET_UTF_8<span class="token punctuation">)</span>
body <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">&quot;xxx&quot;</span></span><span class="token comment">//just for test</span>
String sign <span class="token operator">=</span> DigestUtil<span class="token punctuation">.</span><span class="token function">md5Hex</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span>
request<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;sign&quot;</span></span><span class="token punctuation">,</span>sign<span class="token punctuation">)</span>
</code></pre></div><h2 id="built-in-variable" tabindex="-1"><a class="header-anchor" href="#built-in-variable" aria-hidden="true">#</a> Built-in variable</h2><div class="hint-container danger"><p class="hint-container-title">Notice</p><p>Developers should pay attention to the fact that the built-in variable has been declared in the script edited by themselves instead of creating a new Request or Response object. Otherwise, it may cause unexpected errors.</p></div>`,5),j={href:"https://hutool.cn/",target:"_blank",rel:"noopener noreferrer"},S=n("code",null,"cn.hutool.http.HttpRequest",-1),U={id:"request",tabindex:"-1"},R=n("a",{class:"header-anchor",href:"#request","aria-hidden":"true"},"#",-1),H=n("ul",null,[n("li",null,"Remark: Contains request-related information, such as url, header, body, parameters"),n("li",null,"Type: cn.hutool.http.HttpRequest")],-1),C=n("p",null,"Parameters can be dynamically adjusted by modifying the request value.",-1),P={id:"response",tabindex:"-1"},I=n("a",{class:"header-anchor",href:"#response","aria-hidden":"true"},"#",-1),N=n("ul",null,[n("li",null,"Remark: Contains response information"),n("li",null,"Type: cn.hutool.http.HttpResponse")],-1),T=n("p",null,"You can get the result of the response through the response value.",-1),D={id:"rfr",tabindex:"-1"},B=n("a",{class:"header-anchor",href:"#rfr","aria-hidden":"true"},"#",-1),L=n("ul",null,[n("li",null,"Remark: Contains some properties related to plugin interaction")],-1),A={id:"rfr-projectheader",tabindex:"-1"},J=n("a",{class:"header-anchor",href:"#rfr-projectheader","aria-hidden":"true"},"#",-1),F=n("div",{class:"language-text","data-ext":"text"},[n("pre",{class:"language-text"},[n("code",null,`Remark: Contains project-level headers, which can be modified to dynamically set values in the UI
Type: java.util.LinkedHashMap
`)])],-1),E={id:"rfr-moduleheader",tabindex:"-1"},z=n("a",{class:"header-anchor",href:"#rfr-moduleheader","aria-hidden":"true"},"#",-1),V=n("div",{class:"language-text","data-ext":"text"},[n("pre",{class:"language-text"},[n("code",null,`Remark: Contains module level headers, which can be modified to dynamically set values in the UI
Type: java.util.LinkedHashMap
`)])],-1),G={id:"rfr-currentprojectname",tabindex:"-1"},O=n("a",{class:"header-anchor",href:"#rfr-currentprojectname","aria-hidden":"true"},"#",-1),M=n("div",{class:"language-text","data-ext":"text"},[n("pre",{class:"language-text"},[n("code",null,`Remark: The project name of the item currently selected in the drop-down box
Type: java.lang.String
`)])],-1),Z={id:"rfr-currentenvname",tabindex:"-1"},K=n("a",{class:"header-anchor",href:"#rfr-currentenvname","aria-hidden":"true"},"#",-1),Y=n("div",{class:"language-text","data-ext":"text"},[n("pre",{class:"language-text"},[n("code",null,`Remark: The name of the environment currently selected in the drop-down box
Type: java.lang.String
`)])],-1),Q={id:"rfr-currentdomain",tabindex:"-1"},X=n("a",{class:"header-anchor",href:"#rfr-currentdomain","aria-hidden":"true"},"#",-1),W=n("div",{class:"language-text","data-ext":"text"},[n("pre",{class:"language-text"},[n("code",null,`Remark: Get the currently active domain link
Type: java.lang.String
`)])],-1),$={id:"rfr-currentmodulename",tabindex:"-1"},nn=n("a",{class:"header-anchor",href:"#rfr-currentmodulename","aria-hidden":"true"},"#",-1),sn=e(`<div class="language-text" data-ext="text"><pre class="language-text"><code>Remark: Get the currently module name of the API
Type: java.lang.String
</code></pre></div><h2 id="import-third-jar" tabindex="-1"><a class="header-anchor" href="#import-third-jar" aria-hidden="true">#</a> Import third jar</h2><div class="hint-container tip"><p class="hint-container-title">Built-in Jar</p><div class="language-text" data-ext="text"><pre class="language-text"><code>com.alibaba:fastjson:1.2.78
cn.hutool:hutool-all:5.8.5
com.google.guava:guava:30.1.1-jre
</code></pre></div><p>The version of Jar will be updated from time to time. If you find a bug, please contact up to upgrade.</p><p>Developers can use the tools and methods provided by the above three Jars to reference directly in the script without relying on third-party Jar.</p></div><ul class="task-list-container"><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-1" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-1"> Import jar(maven style)</label></li></ul><p>Downloading the jar may take extra time.</p><div class="language-groovy" data-ext="groovy"><pre class="language-groovy"><code><span class="token annotation punctuation">@Grab</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;org.apache.commons:commons-lang3:3.12.0&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>lang3<span class="token punctuation">.</span>StringUtils

String debug <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;debug&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>StringUtils<span class="token punctuation">.</span><span class="token function">isNotBlank</span><span class="token punctuation">(</span>debug<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//some logic</span>
<span class="token punctuation">}</span>
</code></pre></div><ul class="task-list-container"><li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" id="task-item-2" checked="checked" disabled="disabled"><label class="task-list-item-label" for="task-item-2"> Import jar(by local jar)</label></li></ul><div class="language-groovy" data-ext="groovy"><pre class="language-groovy"><code><span class="token comment">//Note the file: prefix here</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span>classLoader<span class="token punctuation">.</span><span class="token function">addURL</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;file:/path/to/jar&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> StringUtils <span class="token operator">=</span> Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;org.apache.commons.lang3.StringUtils&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeclaredConstructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

String debug <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;debug&quot;</span></span><span class="token punctuation">)</span><span class="token comment">//get header</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>StringUtils<span class="token punctuation">.</span><span class="token function">isNotBlank</span><span class="token punctuation">(</span>debug<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//some logic</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="scope-and-order" tabindex="-1"><a class="header-anchor" href="#scope-and-order" aria-hidden="true">#</a> Scope and order</h2>`,9),an=n("strong",null,"Scope",-1),tn=n("code",null,"Project-level",-1),en=n("code",null,"Single API level",-1),on=n("code",null,"Project-level",-1),pn=n("svg",{class:"icon svg-icon","aria-hidden":"true"},[n("use",{"xlink:href":"#icon-quanjucanshu"})],-1),cn=n("p",null,[n("code",null,"Project-level"),s(" will effort all APIs in the project, and "),n("code",null,"Single API level"),s(" only affects one API.")],-1),ln=n("p",null,[s("Execute orderï¼š"),n("code",null,"Project-level"),s("->"),n("code",null,"Single API level")],-1),rn=n("p",null,[n("img",{src:h,alt:"scriptScope",loading:"lazy"})],-1),un={id:"console",tabindex:"-1"},dn=n("a",{class:"header-anchor",href:"#console","aria-hidden":"true"},"#",-1),kn=e(`<p>The console helps developers print some info you want.</p><div class="language-java" data-ext="java"><pre class="language-java"><code>console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;info&quot;</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;print info&quot;</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;warn&quot;</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">)</span>

</code></pre></div><p><img src="`+l+'" alt="console" loading="lazy"></p><h2 id="demo" tabindex="-1"><a class="header-anchor" href="#demo" aria-hidden="true">#</a> Demo</h2>',4),hn={class:"hint-container tip"},gn=n("p",{class:"hint-container-title"},"1. Sign parameter",-1),mn=n("p",null,"Create a new xxx.groovy file in your local idea, paste the following code. After appropriate modification, it can ensure that the local can run normally and then paste the code into the script.",-1),vn=e(`<p><s>HttpRequest request = HttpUtil.createPost(&quot;http://localhost:8081/book/add&quot;)</s></p><div class="language-groovy line-numbers-mode" data-ext="groovy"><pre class="language-groovy"><code><span class="token keyword">import</span> cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>core<span class="token punctuation">.</span>util<span class="token punctuation">.</span>CharsetUtil
<span class="token keyword">import</span> cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>core<span class="token punctuation">.</span>util<span class="token punctuation">.</span>StrUtil
<span class="token keyword">import</span> cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>digest<span class="token punctuation">.</span>DigestUtil
<span class="token keyword">import</span> cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpRequest
<span class="token keyword">import</span> cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpUtil

<span class="token comment">//Note, note, note, this line of code needs to be deleted in the script</span>
HttpRequest request <span class="token operator">=</span> HttpUtil<span class="token punctuation">.</span><span class="token function">createPost</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;http://localhost:8081/book/add&quot;</span></span><span class="token punctuation">)</span>

<span class="token comment">//Script logic begins</span>
String body <span class="token operator">=</span> StrUtil<span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">bodyBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> CharsetUtil<span class="token punctuation">.</span>CHARSET_UTF_8<span class="token punctuation">)</span>
body <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">&quot;xxxx&quot;</span></span><span class="token comment">//just for test</span>
String sign <span class="token operator">=</span> DigestUtil<span class="token punctuation">.</span><span class="token function">md5Hex</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span>
request<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;sign&quot;</span></span><span class="token punctuation">,</span>sign<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2),fn=e(`<div class="hint-container tip"><p class="hint-container-title">2. Use the response of a request as the Header parameter of the request.</p><div class="language-groovy line-numbers-mode" data-ext="groovy"><pre class="language-groovy"><code><span class="token keyword">import</span> cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>core<span class="token punctuation">.</span>util<span class="token punctuation">.</span>CharsetUtil
<span class="token keyword">import</span> cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>core<span class="token punctuation">.</span>util<span class="token punctuation">.</span>StrUtil
<span class="token keyword">import</span> cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>digest<span class="token punctuation">.</span>DigestUtil
<span class="token keyword">import</span> cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpRequest
<span class="token keyword">import</span> cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpResponse
<span class="token keyword">import</span> cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>http<span class="token punctuation">.</span>HttpUtil
<span class="token keyword">import</span> com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span>JSON

HttpRequest myRequest <span class="token operator">=</span> HttpUtil<span class="token punctuation">.</span><span class="token function">createPost</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;http://localhost:8081/api/v1.0/login&quot;</span></span><span class="token punctuation">)</span>
HttpResponse myResponse <span class="token operator">=</span> myRequest<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>myResponse<span class="token punctuation">.</span><span class="token function">isOk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    String token <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>myResponse<span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;token&quot;</span></span><span class="token punctuation">)</span>
    request<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;token&quot;</span></span><span class="token punctuation">,</span>token<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="note" tabindex="-1"><a class="header-anchor" href="#note" aria-hidden="true">#</a> Note</h2><ul><li>Groovy scripts are not sensitive to <code>;</code>, Java uses <code>;</code> as the end of the statement code, Groovy uses a newline to indicate the end of a code</li><li>The built-in variable has been declared. For example, in Demo 2, if an additional request needs to be created, the variable name needs to be noted that it cannot be the same as the built-in variable.</li></ul><h2 id="script-contribute" tabindex="-1"><a class="header-anchor" href="#script-contribute" aria-hidden="true">#</a> Script contribute ðŸŒŸ</h2><p>In order to make the script more powerful, community script are welcome, and developers can donate the script in comments, develop can <mark>vote</mark> the script if you think the script help much, High-voted and practical scripts will have the opportunity to join to <mark>Plugin page</mark>, so that your homepage gets more attention ðŸ”¥</p><ul><li>Format</li></ul><div class="language-groovy" data-ext="groovy"><pre class="language-groovy"><code><span class="token comment">/**
 * Author:Kings
 * Main Page:https://github.com/kings1990
 * Function:xxxxx
 */</span>

<span class="token comment">//Script begin</span>
<span class="token punctuation">....</span>
</code></pre></div><p><img src="`+g+'" alt="scriptDonate" loading="lazy"></p>',8);function _n(bn,yn){const p=o("ExternalLinkIcon"),c=o("FlowChart"),t=o("Badge"),i=o("RouterLink");return u(),d("div",null,[v,n("p",null,[f,s(": "),n("a",_,[s("Groovy"),a(p)])]),b,y,a(c,{id:"flowchart-12",code:"eJxdizEOwjAQBHu/wmUoXCTpLNkV9Ei8ICEncIHP3K3/zwVRoDS7K+2MImXFIoj+tpfjNqZcauvgDsvor0JB6N1J4fUupe3QZFpfxZhSKfoz+x9i35wyN5IFhavprDj6lDLVLfpL3ZxiWBng1ymYNg5SHk989/S355DJfQBYgjzf",preset:"vue"}),x,n("p",null,[n("a",q,[s("https://github.com/kings1990/fast-request-samples"),a(p)])]),w,n("p",null,[s("Plugin use "),n("a",j,[s("hutool"),a(p)]),s("çš„"),S,s(" send request")]),n("h3",U,[R,s(" request "),a(t,{text:"2022.2.3ï¸",type:"tip"})]),H,C,n("h3",P,[I,s(" response "),a(t,{text:"2022.2.3ï¸",type:"tip"})]),N,T,n("h3",D,[B,s(" rfr "),a(t,{text:"2022.2.3ï¸",type:"tip"})]),L,n("h4",A,[J,s(" rfr.projectHeader "),a(t,{text:"2022.2.3ï¸",type:"tip"})]),F,n("h4",E,[z,s(" rfr.moduleHeader "),a(t,{text:"2022.2.3ï¸",type:"tip"})]),V,n("h4",G,[O,s(" rfr.currentProjectName "),a(t,{text:"2022.2.5ï¸",type:"tip"})]),M,n("h4",Z,[K,s(" rfr.currentEnvName "),a(t,{text:"2022.2.5ï¸",type:"tip"})]),Y,n("h4",Q,[X,s(" rfr.currentDomain "),a(t,{text:"2022.3.1ï¸",type:"tip"})]),W,n("h4",$,[nn,s(" rfr.currentModuleName "),a(t,{text:"2022.3.1ï¸",type:"tip"})]),sn,n("p",null,[an,s(": "),tn,s(" and "),en,s("ï¼Œ"),on,s(" needs to click "),a(i,{to:"/en/guide/features/projectValueConfig.html"},{default:k(()=>[pn,s(" Project-level config")]),_:1}),s(".")]),cn,ln,rn,n("h2",un,[dn,s(" Console "),a(t,{text:"2022.2.5",type:"tip"})]),kn,n("div",hn,[gn,mn,n("ul",null,[n("li",null,[a(t,{text:"Note that the final script needs to remove this line of code",type:"danger"})])]),vn]),fn])}const wn=r(m,[["render",_n],["__file","script.html.vue"]]);export{wn as default};
